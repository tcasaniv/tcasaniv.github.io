---
import type { CollectionEntry } from "astro:content";
import BaseLayout from "./BaseLayout.astro";
import FormattedDate from "../components/FormattedDate.astro";
import AuthorList from "../components/AuthorList.astro";
import CategorieList from "../components/CategorieList.astro";
import { Image } from "astro:assets";

type Props = CollectionEntry<"blog">["data"];

const {
  title,
  description,
  pubDate,
  updatedDate,
  heroImage,
  authors,
  categories,
} = Astro.props;
---

<BaseLayout title={title} description={description}>
  <div class="container-custom py-8">
    <div class="main-content">
      <article class="prose mx-auto">
        {
          heroImage && (
            <div class="mb-6 rounded-lg overflow-hidden">
               <Image width={960} height={480} src={heroImage} alt="" class="w-full h-auto object-cover" />
            </div>
          )
        }
        <h1 class="text-3xl font-bold mb-2 text-[var(--text-main)]">{title}</h1>
        <div class="text-[var(--text-muted)] mb-6 text-sm">
          <FormattedDate date={pubDate} />
          {
            updatedDate && (
              <span class="ml-2 italic">
                (Actualizado: <FormattedDate date={updatedDate} />)
              </span>
            )
          }
        </div>
        
        <hr class="border-[var(--border-color)] mb-8" />
        
        <div class="content">
            <slot />
        </div>

        <hr class="border-[var(--border-color)] my-8" />

        <footer class="mt-8">
          
          {
            categories.length > 0 && (
              <div class="mb-6">
                <h3 class="text-xl font-semibold mb-3">Categor√≠as</h3>
                <CategorieList categories={categories} />
              </div>
            )
          }
          {
            !!authors.length && (
              <div>
                <h3 class="text-xl font-semibold mb-3">Autor{authors.length > 1 ? "es" : ""}</h3>
                <AuthorList
                  class="author-list grid list-none grid-cols-1 gap-4 pl-0"
                  authors={authors}
                  headingLevel={3}
                  showPosts={false}
                />
              </div>
            )
          }
        </footer>
      </article>
    </div>
  </div>
</BaseLayout>

<style is:global>
  .author-list > li {
    @apply rounded-lg border border-[var(--border-color)] p-4 bg-[var(--bg-body)];
  }
</style>